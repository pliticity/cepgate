<div class="with-top-padding">
    <span us-spinner="{radius:30, width:8, length: 16}"></span>

    <form id="form.documentForm" name="form.documentForm" class="form-horizontal">

        <div class="row">

            <div class="col-xs-6">

                <div class="form-group" form-error="" form="form.documentForm" field="classificationId"
                     messages='{"required":"This field is required"}'>
                    <div class="row">
                        <label for="classificationId" class="col-xs-6 control-label">Classification Name</label>
                        <div class="col-xs-6">
                            <select ng-change="classificationSelected()" ng-readonly="readonly()==true" name="classificationName" ng-model="documentInfo.classification.id"
                                    class="form-control" id="classificationName" required="">
                                <option ng-repeat="c in classifications" value="{{c.id}}">{{c.name}} ({{c.classificationId}})</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="form-group" form-error="" form="form.documentForm" field="internalExternal"
                     messages='{"required":"This field is required"}'>
                    <div class="row">
                        <label for="internalExternal" class="col-xs-6 control-label">Internal/External</label>
                        <div class="col-xs-6">
                            <select ng-readonly="readonly()==true" name="internalExternal" class="form-control"
                                    ng-model="documentInfo.kind"
                                    id="internalExternal" required="">
                                <option value="INTERNAL">Internal</option>
                                <option value="EXTERNAL">External</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="form-group" form-error="" form="form.documentForm" field="docType"
                     messages='{"required":"This field is required"}'>
                    <div class="row">
                        <label for="docType" class="col-xs-6 control-label">Document Type</label>
                        <div class="col-xs-6">
                            <select ng-change="typeSelected()" ng-readonly="readonly()==true" name="docType" ng-model="documentInfo.docType.id"
                                    class="form-control" id="docType" required="">
                                <option ng-repeat="dt in types" value="{{dt.id}}">{{dt.name}}</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="form-group" form-error="" form="form.documentForm" field="documentNumber"
                     messages='{"required":"This field is required"}'>
                    <div class="row">
                        <label for="documentNumber" class="col-xs-6 control-label">Document Number</label>
                        <div class="col-xs-6">
                            <input ng-readonly="readonly()==true" class="form-control" name="documentNumber"
                                   id="documentNumber"
                                   ng-model="documentInfo.documentNumber" required=""/>
                        </div>
                    </div>
                </div>

                <div class="form-group" form-error="" form="form.documentForm" field="plannedIssueDate"
                     messages='{"required":"This field is required"}'>
                    <div class="row">
                        <label for="plannedIssueDate" class="col-xs-6 control-label">Planned Issue Date</label>
                        <div class="col-xs-6">
                            <input ng-readonly="readonly()==true" type="text" class="form-control"
                                   ng-model="documentInfo.plannedIssueDate"
                                   name="plannedIssueDate"
                                   id="plannedIssueDate"/>
                            <script>

                                $(document).ready(function () {
                                    $('#plannedIssueDate').datepicker({
                                        format: 'mm/dd/yyyy'
                                    });
                                });
                            </script>
                        </div>
                    </div>
                </div>

                <div class="form-group" form-error="" form="form.documentForm" field="responsibleUser"
                     messages='{"required":"This field is required"}'>
                    <div class="row">
                        <label for="responsibleUser" class="col-xs-6 control-label">Document Responsible</label>
                        <div class="col-xs-6">
                            <div ng-init="principals()"></div>
                            <select ng-readonly="readonly()==true" name="responsibleUser"
                                    ng-model="documentInfo.responsibleUser.id"
                                    class="form-control" id="responsibleUser" required="">
                                <option ng-repeat="u in users" value="{{u.id}}">{{u.email}}</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="form-group" form-error="" form="form.documentForm" field="documentName"
                     messages='{"required":"This field is required"}'>
                    <div class="row">
                        <label for="documentName" class="col-xs-6 control-label">Document Title</label>
                        <div class="col-xs-6">
                        <textarea ng-readonly="readonly()==true" class="form-control" ng-maxlength="300"
                                  ng-model="documentInfo.documentName"
                                  name="documentName"
                                  id="documentName" rows="3" cols="20" required=""/>
                        </div>
                    </div>
                </div>

            </div>


            <div class="col-xs-6">

                <div class="form-group" form-error="" form="form.documentForm" field="classificationId"
                     messages='{"required":"This field is required"}'>
                    <div class="row">
                        <label for="classificationId" class="col-xs-6 control-label">Classification Id</label>
                        <div class="col-xs-6">
                            <input ng-readonly="true" disabled id="classificationId" class="disabled form-control" ng-model="documentInfo.classification.classificationId"/>
                        </div>
                    </div>
                </div>

                <div class="form-group" form-error="" form="form.documentForm" field="securityGroup"
                     messages='{"required":"This field is required"}'>
                    <div class="row">
                        <label for="securityGroup" class="col-xs-6 control-label">Security Group</label>
                        <div class="col-xs-6">
                            <select ng-readonly="readonly()==true" placeholder="Security Group" class="form-control"
                                    name="securityGroup"
                                    id="securityGroup"
                                    ng-model="documentInfo.securityGroup" required="">
                                <option value="User">User</option>
                                <option value="Document Control">Document Control</option>
                                <option value="Sales">Sales</option>
                                <option value="Management">Management</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="form-group" form-error="" form="form.documentForm" field="docTypeId"
                     messages='{"required":"This field is required"}'>
                    <div class="row">
                        <label for="docTypeId" class="col-xs-6 control-label">Document Type ID</label>
                        <div class="col-xs-6">
                            <input ng-readonly="true" disabled id="docTypeId" class="disabled form-control" ng-model="documentInfo.docType.typeId"/>
                        </div>
                    </div>
                </div>

                <div class="form-group" form-error="" form="form.documentForm" field="masterDocumentNumber"
                     messages='{"required":"This field is required"}'>
                    <div class="row">
                        <label for="masterDocumentNumber" class="col-xs-6 control-label">Master Document Number</label>
                        <div class="col-xs-6">
                            <input class="form-control disabled" ng-readonly="true" id="masterDocumentNumber"
                                   ng-model="documentInfo.masterDocumentNumber" required=""/>
                        </div>
                    </div>
                </div>

                <div class="form-group" form-error="" form="form.documentForm" field="creationDate"
                     messages='{"required":"This field is required"}'>
                    <div class="row">
                        <label for="creationDate" class="col-xs-6 control-label">Document Creation Date</label>
                        <div class="col-xs-6">
                            <input type="text" ng-readonly="true" class="form-control disabled"
                                   ng-model="documentInfo.creationDate"
                                   name="creationDate"
                                   id="creationDate"
                                   required=""/>
                        </div>
                    </div>
                </div>

                <div class="form-group" form-error="" form="form.documentForm" field="createdBy"
                     messages='{"required":"This field is required"}'>
                    <div class="row">
                        <label for="createdBy" class="col-xs-6 control-label">Created by</label>
                        <div class="col-xs-6">
                            <input class="form-control disabled" ng-readonly="true" name="createdBy" id="createdBy"
                                   ng-model="documentInfo.createdBy.email"/>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <div class="row">
                        <label class="col-xs-6 control-label">Tags</label>
                        <div class="col-xs-6">
                            <tags-input ng-readonly="readonly()==true" ng-model="documentInfo.tags" id="tags"
                                        name="tags"/>
                        </div>
                    </div>
                </div>

            </div>

        </div>

        <div class="row">
            <div class="col-xs-6">
                <div class="form-group" form-error="" form="form.documentForm" field="provider"
                     messages='{"required":"This field is required"}'>
                    <div class="row">
                        <label class="col-xs-6 control-label">Provider</label>
                        <div class="col-xs-6">
                            <div class="radio">
                                <label>
                                    <input ng-readonly="readonly()==true" type="radio" name="provider"
                                           id="provider_company"
                                           ng-model="documentInfo.provider" value="COMPANY"/> Company
                                </label>
                            </div>
                            <div class="radio">
                                <label>
                                    <input ng-readonly="readonly()==true" type="radio" name="provider"
                                           id="provider_supplier"
                                           ng-model="documentInfo.provider" value="SUPPLIER"/> Supplier
                                </label>
                            </div>
                            <div class="radio">
                                <label>
                                    <input ng-readonly="readonly()==true" type="radio" name="provider"
                                           id="provider_customer"
                                           ng-model="documentInfo.provider" value="CUSTOMER"/> Customer
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <div class="row">
            <div class="col-xs-4">

                <div class="alert alert-info" ng-if="revision==false && documentInfo.state == 'ARCHIVED'">
                    <div class="row">
                        <div class="col-xs-10">This document is archived.
                        </div>
                    </div>
                </div>

                <div class="alert alert-info" ng-if="revision==true">
                    <div class="row">
                        <div class="col-xs-10">
                            <strong>Warning!</strong> This is a revision of the document
                        </div>
                        <div class="col-xs-2 text-right">
                            <button ng-if="revision==true" class="btn btn-info btn-xs" ng-click="get(documentInfo.id)">
                                Back
                            </button>
                        </div>
                    </div>
                </div>

            </div>

            <div class="col-xs-4 col-xs-offset-4 text-right">
                <input ng-if="readonly()==false && documentInfo.id" class="btn btn-primary" type="button"
                       ng-click="save()" value="Save"/>
                <input ng-if="revision==false && documentInfo.id && !documentInfo.favourite" class="btn btn-warning"
                       type="button"
                       ng-click="favourite()" value="Mark as favourite"/>

                <button ng-if="readonly()==false && documentInfo.id" class="btn btn-info" ng-click="archive()">Archive</button>
                <a class="btn btn-info" ng-if="revision==false && documentInfo.state == 'ARCHIVED'" ng-click="createRevision()">Create New Revison
                </a>

                <input ng-if="revision==false && documentInfo.id && documentInfo.favourite" class="btn btn-default"
                       type="button"
                       ng-click="unFavourite()" value="UnMark as favourite"/>

                <input ng-if="readonly()==false && !documentInfo.id" class="btn btn-primary" type="button"
                       ng-click="create()" value="Save"/>

            </div>
        </div>

    </form>

    <ul id="details-{{documentInfo.id}}-tabs" class="nav nav-pills" role="tablist">
        <li role="presentation" class="active">
            <a href="#in-progress-{{documentInfo.id}}" aria-controls="in-progress-{{documentInfo.id}}" role="tab"
               data-toggle="tab">
                <span ng-if="documentInfo.state == 'ARCHIVED' && revision == false">
                    Archived revision
                </span>
                <span ng-if="revision == true">
                    Revision {{documentInfo.revision.prefix}}
                </span>
                <span ng-if="documentInfo.state != 'ARCHIVED' && revision == false">
                    Current Revision
                </span>
            </a>
        </li>
        <li has-role="DOCUMENT_CONTROL,MANAGEMENT" ng-if="revision==false" role="presentation" class=""><a href="#history-{{documentInfo.id}}"
                                                                    aria-controls="history-{{documentInfo.id}}"
                                                                    role="tab"
                                                                    data-toggle="tab">Revision History</a>
        </li>
        <li ng-if="revision==false" role="presentation" class=""><a href="#comments-{{documentInfo.id}}"
                                                                    aria-controls="comments-{{documentInfo.id}}"
                                                                    role="tab"
                                                                    data-toggle="tab">Comments</a></li>
        <li ng-if="revision==false" role="presentation" class=""><a href="#links-{{documentInfo.id}}"
                                                                    aria-controls="links-{{documentInfo.id}}" role="tab"
                                                                    data-toggle="tab">Links</a></li>
    </ul>

    <div class="tab-content" id="details-{{documentInfo.id}}-tabs-content">

        <div role="tabpanel" class="tab-pane active" id="in-progress-{{documentInfo.id}}">

            <div class="row text-left">
                    <div class="col-xs-3 form-group" form-error="" form="form.documentForm" field="state" messages='{"required":"This field is required"}'>
                        <div class="row">
                            <label for="state" class="col-xs-2 control-label">State</label>
                            <div class="col-xs-6">
                                <input class="form-control disabled" name="state" id="state"
                                       ng-model="documentInfo.state" ng-readonly="true"/>
                            </div>
                        </div>
                    </div>

                    <div class="col-xs-3 form-group" form-error="" form="form.documentForm" field="revision"
                         messages='{"required":"This field is required"}'>
                        <div class="row">
                            <label for="revision" class="col-xs-2 control-label">Revision</label>
                            <div class="col-xs-6">
                                <div class="input-group">
                                    <input ng-readonly="readonly()==true" class="form-control" name="revision"
                                           id="revision"
                                           ng-model="documentInfo.revision.prefix">
                                    <!--<span class="input-group-addon">{{documentInfo.revision.number}}</span>-->
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-xs-4 form-group" form-error="" form="form.documentForm" field="archivedDate"
                         messages='{"required":"This field is required"}'>
                        <div class="row">
                            <label for="revision" class="col-xs-4 control-label">Revision Date</label>
                            <div class="col-xs-6">
                                <div class="input-group">
                                    <input ng-readonly="true" class="form-control" disabled name="archivedDate"
                                           id="archivedDate"
                                           ng-model="documentInfo.archivedDate">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            <ng-include src="'/partials/document/files.html'"></ng-include>
        </div>
        <div role="tabpanel" class="tab-pane" id="history-{{documentInfo.id}}">
            <ng-include src="'/partials/document/history.html'"></ng-include>
        </div>
        <div role="tabpanel" class="tab-pane" id="comments-{{documentInfo.id}}">
            <ng-include src="'/partials/document/comments.html'"></ng-include>
        </div>
        <div role="tabpanel" class="tab-pane" id="links-{{documentInfo.id}}">
            <ng-include src="'/partials/document/links.html'"></ng-include>
        </div>
    </div>

</div>